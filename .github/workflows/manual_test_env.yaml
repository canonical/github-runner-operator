name: Manual test env

on:
  # TODO: Uncomment
  pull_request:
  workflow_dispatch:

jobs:
  manual-test-env:
    name: manual-test-env
    runs-on: ["self-hosted", "stg-private-endpoint"]
    steps:
      - run: sudo apt update -yq
      - run: sudo apt install pipx -yq
      - run: pipx ensurepath
      - run: pipx install tox
      - uses: actions/checkout@v4
      - name: Tmate debugging session (self-hosted)
        uses: canonical/action-tmate@main
        timeout-minutes: ${{ inputs.tmate-timeout }}
  # openstack-integration-tests-private-endpoint:
  #   name: Integration test using private-endpoint
  #   uses: canonical/operator-workflows/.github/workflows/integration_test.yaml@main
  #   secrets: inherit
  #   with:
  #     juju-channel: 3.2/stable
  #     pre-run-script: scripts/setup-lxd.sh
  #     provider: lxd
  #     test-tox-env: integration-juju3.2
  #     modules: '["test_runner_manager_openstack"]'
  #     extra-arguments: "-m openstack"
  #     self-hosted-runner: true
  #     self-hosted-runner-label: stg-private-endpoint
  #     tmate-debug: true
  #     tmate-timeout: 300
