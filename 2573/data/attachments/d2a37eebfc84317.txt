06:25:14 INFO Adding model github-pr-b51b1-lxd:test-debug-ssh-ox6p on cloud localhost
06:25:14 WARNING unexpected facade AgentLifeFlag received from the controller
06:25:14 WARNING unknown common facade version for AgentLifeFlag,
versions known to client : [2, 3]
versions known to controller : [1]
06:25:14 WARNING unexpected facade SecretsDrain received from the controller
06:25:17 INFO Deploying ch:amd64/github-runner-image-builder-68
06:25:40 INFO Deploying local:jammy/github-runner-0
06:25:40 INFO Waiting for model:
  test-ue3n2bj9/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-ue3n2bj9/0 [allocating] waiting: waiting for machine
06:26:10 INFO Waiting for model:
  test-ue3n2bj9/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-ue3n2bj9/0 [allocating] waiting: waiting for machine
06:26:40 INFO Waiting for model:
  test-ue3n2bj9/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-ue3n2bj9/0 [allocating] waiting: waiting for machine
06:27:10 INFO Waiting for model:
  test-ue3n2bj9/0 [executing] maintenance: installing charm software
  github-runner-image-builder-ue3n2bj9/0 [executing] maintenance: Setting up Builder.
06:27:40 INFO Waiting for model:
  test-ue3n2bj9/0 [executing] maintenance: Reconciling runners
  github-runner-image-builder-ue3n2bj9/0 [executing] maintenance: Setting up Builder.
06:28:10 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] blocked: Please provide image integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] maintenance: Setting up Builder.
06:28:40 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] blocked: Please provide image integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] maintenance: Setting up Builder.
06:29:11 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] blocked: Please provide image integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] maintenance: Setting up Builder.
06:29:41 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] blocked: Please provide image integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] maintenance: Setting up Builder.
06:30:11 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] blocked: Please provide image integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] maintenance: Setting up Builder.
06:30:41 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:31:11 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:31:41 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:32:11 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:32:41 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:33:11 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:33:41 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:34:11 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:34:41 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:35:11 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:35:42 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:36:12 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:36:42 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:37:12 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:37:42 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:38:12 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:38:42 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:39:12 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:39:42 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:40:12 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:40:42 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:41:12 INFO Waiting for model:
  test-ue3n2bj9/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-ue3n2bj9/0 [executing] active: Building image.
06:41:43 INFO Waiting for model:
  test-ue3n2bj9/0 [executing] maintenance: Update image for runners
  github-runner-image-builder-ue3n2bj9/0 [idle] active: 
06:42:13 INFO Waiting for model:
  test-ue3n2bj9/0 [executing] maintenance: Reconciling runners
06:42:36 INFO GitHub token rate limit: Rate(reset=2025-05-02 07:19:33+00:00, remaining=4882, limit=5000)
06:42:40 INFO Deploying ch:amd64/jammy/tmate-ssh-server-10
06:42:40 WARNING relate is deprecated and will be removed. Use integrate instead.
06:42:40 INFO Waiting for model:
  tmate-ssh-server/0 [allocating] waiting: waiting for machine
06:43:10 INFO Waiting for model:
  tmate-ssh-server/0 [allocating] waiting: waiting for machine
06:43:40 INFO Waiting for model:
  tmate-ssh-server/0 [executing] maintenance: Installing packages.
06:44:07 INFO Waiting for model:
  github-runner-image-builder-ue3n2bj9/0 [idle] active: 
  test-ue3n2bj9/0 [executing] maintenance: Reconciling runners
  tmate-ssh-server/0 [idle] active: 
06:44:37 INFO Waiting for model:
  test-ue3n2bj9/0 [executing] maintenance: Reconciling runners
06:45:07 INFO Waiting for model:
  test-ue3n2bj9/0 [executing] maintenance: Reconciling runners
06:45:37 INFO Waiting for model:
  test-ue3n2bj9/0 [executing] maintenance: Reconciling runners
06:46:07 INFO Waiting for model:
  test-ue3n2bj9/0 [executing] maintenance: Added debug-ssh relation
  tmate-ssh-server/0 [idle] active: 
06:46:38 INFO Waiting for model:
  test-ue3n2bj9/0 [executing] maintenance: Reconciling runners
06:47:04 INFO [TEST SETUP] Run command sudo iptables -t nat -A OUTPUT -p tcp -d 10.181.203.92 --dport 10022 -j DNAT --to-destination 127.0.0.1:10022 on test-ue3n2bj9-0-n-e5f05ec1dd79
06:47:04 WARNING dict_values([])
06:47:06 INFO Model status:

Model                Controller           Cloud/Region         Version  SLA          Timestamp
test-debug-ssh-ox6p  github-pr-b51b1-lxd  localhost/localhost  3.1.10   unsupported  06:47:06Z

App                                   Version  Status  Scale  Charm                        Channel      Rev  Exposed  Message
github-runner-image-builder-ue3n2bj9           active      1  github-runner-image-builder  latest/edge   68  no       
test-ue3n2bj9                                  active      1  github-runner                               0  no       
tmate-ssh-server                               active      1  tmate-ssh-server             edge          10  no       

Unit                                     Workload  Agent  Machine  Public address  Ports      Message
github-runner-image-builder-ue3n2bj9/0*  active    idle   0        10.181.203.48              
test-ue3n2bj9/0*                         active    idle   1        10.181.203.39              
tmate-ssh-server/0*                      active    idle   2        10.181.203.92   10022/tcp  

Machine  State    Address        Inst id        Base          AZ  Message
0        started  10.181.203.48  juju-44ea17-0  ubuntu@22.04      Running
1        started  10.181.203.39  juju-44ea17-1  ubuntu@22.04      Running
2        started  10.181.203.92  juju-44ea17-2  ubuntu@22.04      Running

06:47:06 INFO Juju error logs:

machine-1: 06:26:41 ERROR juju.worker.dependency "broker-tracker" manifold worker returned unexpected error: no container types determined
machine-1: 06:26:41 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-1: 06:26:41 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-test-ue3n2bj9-0: 06:26:41 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
machine-0: 06:26:46 ERROR juju.worker.dependency "broker-tracker" manifold worker returned unexpected error: no container types determined
machine-0: 06:26:46 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-0: 06:26:46 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-github-runner-image-builder-ue3n2bj9-0: 06:26:46 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-test-ue3n2bj9-0: 06:27:19 ERROR unit.test-ue3n2bj9/0.juju-log Command python3 -m pip uninstall github_runner_manager failed with code 2: b'ERROR: Exception:\nTraceback (most recent call last):\n  File "/usr/local/lib/python3.10/dist-packages/pip/_internal/cli/base_command.py", line 105, in _run_wrapper\n    status = _inner_run()\n  File "/usr/local/lib/python3.10/dist-packages/pip/_internal/cli/base_command.py", line 96, in _inner_run\n    return self.run(options, args)\n  File "/usr/local/lib/python3.10/dist-packages/pip/_internal/commands/uninstall.py", line 106, in run\n    uninstall_pathset = req.uninstall(\n  File "/usr/local/lib/python3.10/dist-packages/pip/_internal/req/req_install.py", line 723, in uninstall\n    uninstalled_pathset.remove(auto_confirm, verbose)\n  File "/usr/local/lib/python3.10/dist-packages/pip/_internal/req/req_uninstall.py", line 364, in remove\n    if auto_confirm or self._allowed_to_proceed(verbose):\n  File "/usr/local/lib/python3.10/dist-packages/pip/_internal/req/req_uninstall.py", line 404, in _allowed_to_proceed\n    return ask("Proceed (Y/n)? ", ("y", "n", "")) != "n"\n  File "/usr/local/lib/python3.10/dist-packages/pip/_internal/utils/misc.py", line 227, in ask\n    response = input(message)\nEOFError: EOF when reading a line\n'
unit-github-runner-image-builder-ue3n2bj9-0: 06:27:29 ERROR unit.github-runner-image-builder-ue3n2bj9/0.juju-log Pipx command failed, code: 1, out: None, err: None
machine-2: 06:43:32 ERROR juju.worker.dependency "broker-tracker" manifold worker returned unexpected error: no container types determined
machine-2: 06:43:32 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-2: 06:43:32 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-tmate-ssh-server-0: 06:43:32 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-test-ue3n2bj9-0: 06:46:28 ERROR unit.test-ue3n2bj9/0.juju-log debug-ssh:1: Unable to get SSH connection for instance test-ue3n2bj9-0-n-e5f05ec1dd79, marking as unhealthy.
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/health_checks.py", line 132, in _get_ssh_connection
    ssh_conn = openstack_cloud.get_ssh_connection(instance)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/openstack_cloud.py", line 142, in exception_handling_wrapper
    return func(*args, **kwargs)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/openstack_cloud.py", line 341, in get_ssh_connection
    raise KeyfileError(
github_runner_manager.errors.KeyfileError: Missing keyfile for server: test-ue3n2bj9-0-n-e5f05ec1dd79, key path: /home/runner-manager/.ssh/test-ue3n2bj9-0-n-e5f05ec1dd79.key

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/health_checks.py", line 49, in check_runner
    ssh_conn = _get_ssh_connection(openstack_cloud=openstack_cloud, instance=instance)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/utilities.py", line 77, in fn_with_retry
    return func(*args, **kwargs)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/health_checks.py", line 135, in _get_ssh_connection
    raise _SSHError(f"Unable to get SSH connection to {instance.instance_id}") from exc
github_runner_manager.openstack_cloud.health_checks._SSHError: Unable to get SSH connection to test-ue3n2bj9-0-n-e5f05ec1dd79
unit-test-ue3n2bj9-0: 06:46:31 ERROR unit.test-ue3n2bj9/0.juju-log debug-ssh:1: Unable to get SSH connection for instance test-ue3n2bj9-0-n-e5f05ec1dd79, marking as unhealthy.
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/health_checks.py", line 132, in _get_ssh_connection
    ssh_conn = openstack_cloud.get_ssh_connection(instance)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/openstack_cloud.py", line 142, in exception_handling_wrapper
    return func(*args, **kwargs)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/openstack_cloud.py", line 341, in get_ssh_connection
    raise KeyfileError(
github_runner_manager.errors.KeyfileError: Missing keyfile for server: test-ue3n2bj9-0-n-e5f05ec1dd79, key path: /home/runner-manager/.ssh/test-ue3n2bj9-0-n-e5f05ec1dd79.key

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/health_checks.py", line 49, in check_runner
    ssh_conn = _get_ssh_connection(openstack_cloud=openstack_cloud, instance=instance)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/utilities.py", line 77, in fn_with_retry
    return func(*args, **kwargs)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/health_checks.py", line 135, in _get_ssh_connection
    raise _SSHError(f"Unable to get SSH connection to {instance.instance_id}") from exc
github_runner_manager.openstack_cloud.health_checks._SSHError: Unable to get SSH connection to test-ue3n2bj9-0-n-e5f05ec1dd79
unit-test-ue3n2bj9-0: 06:46:31 ERROR unit.test-ue3n2bj9/0.juju-log debug-ssh:1: Failed to get SSH connection while removing test-ue3n2bj9-0-n-e5f05ec1dd79
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/openstack_runner_manager.py", line 311, in _delete_runner
    ssh_conn = self._openstack_cloud.get_ssh_connection(instance)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/openstack_cloud.py", line 142, in exception_handling_wrapper
    return func(*args, **kwargs)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/openstack_cloud.py", line 341, in get_ssh_connection
    raise KeyfileError(
github_runner_manager.errors.KeyfileError: Missing keyfile for server: test-ue3n2bj9-0-n-e5f05ec1dd79, key path: /home/runner-manager/.ssh/test-ue3n2bj9-0-n-e5f05ec1dd79.key
unit-test-ue3n2bj9-0: 06:46:35 ERROR unit.test-ue3n2bj9/0.juju-log debug-ssh:1: Invalid pulled metrics. No runner_installed information for test-ue3n2bj9-0-n-e5f05ec1dd79.
unit-test-ue3n2bj9-0: 06:46:35 ERROR unit.test-ue3n2bj9/0.juju-log debug-ssh:1: No metrics returned after deleting test-ue3n2bj9-0-n-e5f05ec1dd79
unit-test-ue3n2bj9-0: 06:46:41 ERROR unit.test-ue3n2bj9/0.juju-log debug-ssh:1: Unable to get SSH connection for instance test-ue3n2bj9-0-n-e5f05ec1dd79, marking as unhealthy.
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/health_checks.py", line 132, in _get_ssh_connection
    ssh_conn = openstack_cloud.get_ssh_connection(instance)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/openstack_cloud.py", line 142, in exception_handling_wrapper
    return func(*args, **kwargs)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/openstack_cloud.py", line 341, in get_ssh_connection
    raise KeyfileError(
github_runner_manager.errors.KeyfileError: Missing keyfile for server: test-ue3n2bj9-0-n-e5f05ec1dd79, key path: /home/runner-manager/.ssh/test-ue3n2bj9-0-n-e5f05ec1dd79.key

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/health_checks.py", line 49, in check_runner
    ssh_conn = _get_ssh_connection(openstack_cloud=openstack_cloud, instance=instance)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/utilities.py", line 77, in fn_with_retry
    return func(*args, **kwargs)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/health_checks.py", line 135, in _get_ssh_connection
    raise _SSHError(f"Unable to get SSH connection to {instance.instance_id}") from exc
github_runner_manager.openstack_cloud.health_checks._SSHError: Unable to get SSH connection to test-ue3n2bj9-0-n-e5f05ec1dd79
unit-test-ue3n2bj9-0: 06:46:45 ERROR unit.test-ue3n2bj9/0.juju-log debug-ssh:1: Unable to get SSH connection for instance test-ue3n2bj9-0-n-e5f05ec1dd79, marking as unhealthy.
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/health_checks.py", line 132, in _get_ssh_connection
    ssh_conn = openstack_cloud.get_ssh_connection(instance)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/openstack_cloud.py", line 142, in exception_handling_wrapper
    return func(*args, **kwargs)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/openstack_cloud.py", line 341, in get_ssh_connection
    raise KeyfileError(
github_runner_manager.errors.KeyfileError: Missing keyfile for server: test-ue3n2bj9-0-n-e5f05ec1dd79, key path: /home/runner-manager/.ssh/test-ue3n2bj9-0-n-e5f05ec1dd79.key

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/health_checks.py", line 49, in check_runner
    ssh_conn = _get_ssh_connection(openstack_cloud=openstack_cloud, instance=instance)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/utilities.py", line 77, in fn_with_retry
    return func(*args, **kwargs)
  File "/var/lib/juju/agents/unit-test-ue3n2bj9-0/charm/venv/github_runner_manager/openstack_cloud/health_checks.py", line 135, in _get_ssh_connection
    raise _SSHError(f"Unable to get SSH connection to {instance.instance_id}") from exc
github_runner_manager.openstack_cloud.health_checks._SSHError: Unable to get SSH connection to test-ue3n2bj9-0-n-e5f05ec1dd79

06:47:07 INFO Forgetting model main...