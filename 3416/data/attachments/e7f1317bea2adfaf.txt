06:25:17 WARNING unexpected facade SSHServer received from the controller
06:25:17 INFO Adding model github-pr-539f0-lxd:test-charm-fork-path-change-e5yu on cloud localhost
06:25:18 WARNING unexpected facade SSHServer received from the controller
06:25:18 WARNING unexpected facade SSHSession received from the controller
06:25:18 WARNING unexpected facade SSHTunneler received from the controller
06:25:19 INFO Deploying ch:amd64/jammy/github-runner-image-builder-106
06:25:40 INFO Deploying local:jammy/github-runner-0
06:25:40 INFO Waiting for model:
  test-q1eaji6r/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-q1eaji6r/0 [allocating] waiting: waiting for machine
06:26:10 INFO Waiting for model:
  test-q1eaji6r/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-q1eaji6r/0 [allocating] waiting: waiting for machine
06:26:40 INFO Waiting for model:
  test-q1eaji6r/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-q1eaji6r/0 [allocating] waiting: waiting for machine
06:27:11 INFO Waiting for model:
  test-q1eaji6r/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-q1eaji6r/0 [allocating] waiting: agent initialising
06:27:41 INFO Waiting for model:
  test-q1eaji6r/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-q1eaji6r/0 [executing] maintenance: Setting up Builder.
06:28:11 INFO Waiting for model:
  test-q1eaji6r/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-q1eaji6r/0 [executing] maintenance: Setting up Builder.
06:28:41 INFO Waiting for model:
  test-q1eaji6r/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-q1eaji6r/0 [executing] maintenance: Setting up Builder.
06:29:11 INFO Waiting for model:
  test-q1eaji6r/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-q1eaji6r/0 [executing] maintenance: Setting up Builder.
06:29:42 INFO Waiting for model:
  test-q1eaji6r/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-q1eaji6r/0 [executing] maintenance: Setting up Builder.
06:30:12 INFO Waiting for model:
  test-q1eaji6r/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-q1eaji6r/0 [executing] maintenance: Setting up Builder.
06:30:42 INFO Waiting for model:
  test-q1eaji6r/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-q1eaji6r/0 [executing] maintenance: Setting up Builder.
06:31:12 INFO Waiting for model:
  test-q1eaji6r/0 [allocating] waiting: waiting for machine
  github-runner-image-builder-q1eaji6r/0 [idle] blocked: image integration required.
06:31:43 INFO Waiting for model:
  test-q1eaji6r/0 [executing] waiting: agent initialising
  github-runner-image-builder-q1eaji6r/0 [idle] blocked: image integration required.
06:32:13 INFO Waiting for model:
  test-q1eaji6r/0 [executing] maintenance: installing charm software
  github-runner-image-builder-q1eaji6r/0 [idle] blocked: image integration required.
06:32:43 INFO Waiting for model:
  test-q1eaji6r/0 [executing] maintenance: installing charm software
  github-runner-image-builder-q1eaji6r/0 [idle] blocked: image integration required.
06:33:13 INFO Waiting for model:
  test-q1eaji6r/0 [executing] maintenance: installing charm software
  github-runner-image-builder-q1eaji6r/0 [idle] blocked: image integration required.
06:33:44 INFO Waiting for model:
  test-q1eaji6r/0 [executing] maintenance: installing charm software
  github-runner-image-builder-q1eaji6r/0 [idle] blocked: image integration required.
06:34:14 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:34:44 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:35:14 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:35:44 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:36:15 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:36:45 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:37:15 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:37:45 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:38:16 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:38:46 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:39:16 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:39:46 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:40:17 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:40:47 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:41:17 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:41:47 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:42:17 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:42:47 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:43:18 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:43:48 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:44:19 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:44:49 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:45:19 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:45:49 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:46:20 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:46:50 INFO Waiting for model:
  test-q1eaji6r/0 [idle] waiting: Waiting for image over integration.
  github-runner-image-builder-q1eaji6r/0 [executing] active: Building image.
06:47:20 INFO Waiting for model:
  test-q1eaji6r/0 [executing] maintenance: Update image for runners
06:47:46 INFO GitHub token rate limit: Rate(reset=2025-08-20 06:59:47+00:00, remaining=4831, limit=5000)
06:47:58 INFO test_path_config_change
06:47:58 INFO Waiting for model:
  test-q1eaji6r/0 [idle] active: 
06:48:28 INFO Waiting for model:
  test-q1eaji6r/0 [idle] active: 
06:48:55 INFO Ensure there is a runner (this calls reconcile)
06:48:55 INFO Waiting for model:
  test-q1eaji6r/0 [idle] active: 
06:49:25 INFO Waiting for model:
  test-q1eaji6r/0 [idle] active: 
06:49:28 INFO Current reconcile ID: 965f5db5-422f-4bbf-a972-32f47e72c8b8
06:50:29 INFO Current reconcile ID: 965f5db5-422f-4bbf-a972-32f47e72c8b8
06:51:30 INFO Current reconcile ID: 83d60ee2-ecdb-407d-aa57-f96a162f0d5a
06:51:35 INFO Reconciling (again)
06:51:35 INFO Waiting for model:
  test-q1eaji6r/0 [idle] active:
06:52:02 INFO Application log: 
2025-08-20 06:47:06,970 - INFO - root - Starting GitHub runner manager service version: 0.6.1
2025-08-20 06:47:06,980 - INFO - github_runner_manager.http_server - Starting the server...
2025-08-20 06:47:06,981 - INFO - github_runner_manager.reconcile_service - Starting the reconcile service...
 * Serving Flask app 'github_runner_manager.http_server'
2025-08-20 06:47:06,981 - INFO - github_runner_manager.reconcile_service - Start reconciliation
 * Debug mode: off
2025-08-20 06:47:07,003 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:55555
2025-08-20 06:47:07,003 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-08-20 06:47:07,018 - INFO - github_runner_manager.manager.runner_scaler - Start reconcile. base_quantity 0. max_quantity: 0.
2025-08-20 06:47:07,018 - INFO - github_runner_manager.manager.runner_manager - runner_manager::cleanup
2025-08-20 06:47:07,018 - INFO - github_runner_manager.manager.runner_manager -  _cleanup_resources idle: False, force: False
2025-08-20 06:47:07,019 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:47:08,981 - INFO - github_runner_manager.manager.runner_manager - cleanup cloud_runners []
2025-08-20 06:47:10,315 - INFO - github_runner_manager.manager.runner_manager - cleanup health_response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:47:11,811 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up SSH key files
2025-08-20 06:47:11,811 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Found 0 key files, clean up 0 key files
2025-08-20 06:47:11,811 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up openstack keypairs
2025-08-20 06:47:11,844 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:47:14,617 - INFO - github_runner_manager.manager.runner_manager - clouds runners response []
2025-08-20 06:47:14,618 - INFO - github_runner_manager.manager.runner_manager - runner health response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:47:14,618 - INFO - github_runner_manager.manager.runner_scaler - Reconcile runners from 0 to 0
2025-08-20 06:47:14,618 - INFO - github_runner_manager.manager.runner_scaler - No changes to the number of runners.
2025-08-20 06:47:14,618 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:47:17,198 - INFO - github_runner_manager.manager.runner_manager - clouds runners response []
2025-08-20 06:47:17,199 - INFO - github_runner_manager.manager.runner_manager - runner health response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:47:17,199 - INFO - github_runner_manager.manager.runner_scaler - Found 0 busy runners: []
2025-08-20 06:47:17,199 - INFO - github_runner_manager.manager.runner_scaler - Found 0 idle runners: []
2025-08-20 06:47:17,199 - INFO - github_runner_manager.manager.runner_scaler - Found 0 offline runners that are healthy: []
2025-08-20 06:47:17,199 - INFO - github_runner_manager.manager.runner_scaler - Found 0 unhealthy runners: []
2025-08-20 06:47:17,199 - INFO - github_runner_manager.manager.runner_scaler - Current available runners (idle + healthy offline): set()
2025-08-20 06:47:17,199 - INFO - github_runner_manager.manager.runner_scaler - Current active runners: set()
2025-08-20 06:47:17,200 - INFO - github_runner_manager.manager.runner_scaler - Finished reconciliation.
2025-08-20 06:47:17,200 - INFO - github_runner_manager.reconcile_service - Change in number of runner after reconcile: 0
2025-08-20 06:47:17,200 - INFO - github_runner_manager.reconcile_service - End reconciliation
2025-08-20 06:47:21,267 - INFO - werkzeug - 127.0.0.1 - - [20/Aug/2025 06:47:21] "[35m[1mGET /health HTTP/1.1[0m" 204 -
2025-08-20 06:47:21,279 - INFO - werkzeug - 127.0.0.1 - - [20/Aug/2025 06:47:21] "[35m[1mGET /health HTTP/1.1[0m" 204 -
2025-08-20 06:47:21,288 - INFO - github_runner_manager.http_server - Attempting to acquire the lock: unlocked
2025-08-20 06:47:21,289 - INFO - github_runner_manager.http_server - Flushing runners...
2025-08-20 06:47:21,323 - INFO - github_runner_manager.http_server - Flushing busy: False
2025-08-20 06:47:21,323 - INFO - github_runner_manager.manager.runner_manager - runner_manager::cleanup
2025-08-20 06:47:21,323 - INFO - github_runner_manager.manager.runner_manager -  _cleanup_resources idle: False, force: False
2025-08-20 06:47:21,324 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:47:23,293 - INFO - github_runner_manager.manager.runner_manager - cleanup cloud_runners []
2025-08-20 06:47:24,579 - INFO - github_runner_manager.manager.runner_manager - cleanup health_response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:47:25,779 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up SSH key files
2025-08-20 06:47:25,779 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Found 0 key files, clean up 0 key files
2025-08-20 06:47:25,779 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up openstack keypairs
2025-08-20 06:47:25,809 - INFO - github_runner_manager.manager.runner_manager - runner_manager::flush_runners. mode FlushMode.FLUSH_IDLE
2025-08-20 06:47:25,810 - INFO - github_runner_manager.manager.runner_manager - Flushing idle runners...
2025-08-20 06:47:25,810 - INFO - github_runner_manager.manager.runner_manager -  _cleanup_resources idle: True, force: False
2025-08-20 06:47:25,810 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:47:27,280 - INFO - github_runner_manager.manager.runner_manager - cleanup cloud_runners []
2025-08-20 06:47:28,545 - INFO - github_runner_manager.manager.runner_manager - cleanup health_response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:47:30,183 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up SSH key files
2025-08-20 06:47:30,183 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Found 0 key files, clean up 0 key files
2025-08-20 06:47:30,184 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up openstack keypairs
2025-08-20 06:47:30,209 - INFO - github_runner_manager.http_server - Flushed 0 runners
2025-08-20 06:47:30,209 - INFO - werkzeug - 127.0.0.1 - - [20/Aug/2025 06:47:30] "[35m[1mPOST /runner/flush?flush-busy=False HTTP/1.1[0m" 204 -
2025-08-20 06:48:00,461 - INFO - root - Starting GitHub runner manager service version: 0.6.1
2025-08-20 06:48:00,472 - INFO - github_runner_manager.http_server - Starting the server...
2025-08-20 06:48:00,472 - INFO - github_runner_manager.reconcile_service - Starting the reconcile service...
 * Serving Flask app 'github_runner_manager.http_server'
 * Debug mode: off
2025-08-20 06:48:00,473 - INFO - github_runner_manager.reconcile_service - Start reconciliation
2025-08-20 06:48:00,474 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:55555
2025-08-20 06:48:00,474 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-08-20 06:48:00,522 - INFO - github_runner_manager.manager.runner_scaler - Start reconcile. base_quantity 0. max_quantity: 0.
2025-08-20 06:48:00,522 - INFO - github_runner_manager.manager.runner_manager - runner_manager::cleanup
2025-08-20 06:48:00,522 - INFO - github_runner_manager.manager.runner_manager -  _cleanup_resources idle: False, force: False
2025-08-20 06:48:00,522 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:48:02,290 - INFO - github_runner_manager.manager.runner_manager - cleanup cloud_runners []
2025-08-20 06:48:03,429 - INFO - github_runner_manager.manager.runner_manager - cleanup health_response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:48:04,925 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up SSH key files
2025-08-20 06:48:04,925 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Found 0 key files, clean up 0 key files
2025-08-20 06:48:04,925 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up openstack keypairs
2025-08-20 06:48:04,948 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:48:08,078 - INFO - github_runner_manager.manager.runner_manager - clouds runners response []
2025-08-20 06:48:08,078 - INFO - github_runner_manager.manager.runner_manager - runner health response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:48:08,078 - INFO - github_runner_manager.manager.runner_scaler - Reconcile runners from 0 to 0
2025-08-20 06:48:08,078 - INFO - github_runner_manager.manager.runner_scaler - No changes to the number of runners.
2025-08-20 06:48:08,079 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:48:10,679 - INFO - github_runner_manager.manager.runner_manager - clouds runners response []
2025-08-20 06:48:10,679 - INFO - github_runner_manager.manager.runner_manager - runner health response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:48:10,679 - INFO - github_runner_manager.manager.runner_scaler - Found 0 busy runners: []
2025-08-20 06:48:10,679 - INFO - github_runner_manager.manager.runner_scaler - Found 0 idle runners: []
2025-08-20 06:48:10,679 - INFO - github_runner_manager.manager.runner_scaler - Found 0 offline runners that are healthy: []
2025-08-20 06:48:10,680 - INFO - github_runner_manager.manager.runner_scaler - Found 0 unhealthy runners: []
2025-08-20 06:48:10,680 - INFO - github_runner_manager.manager.runner_scaler - Current available runners (idle + healthy offline): set()
2025-08-20 06:48:10,680 - INFO - github_runner_manager.manager.runner_scaler - Current active runners: set()
2025-08-20 06:48:10,681 - INFO - github_runner_manager.manager.runner_scaler - Finished reconciliation.
2025-08-20 06:48:10,681 - INFO - github_runner_manager.reconcile_service - Change in number of runner after reconcile: 0
2025-08-20 06:48:10,681 - INFO - github_runner_manager.reconcile_service - End reconciliation
2025-08-20 06:48:14,725 - INFO - werkzeug - 127.0.0.1 - - [20/Aug/2025 06:48:14] "[35m[1mGET /health HTTP/1.1[0m" 204 -
2025-08-20 06:48:14,741 - INFO - werkzeug - 127.0.0.1 - - [20/Aug/2025 06:48:14] "[35m[1mGET /health HTTP/1.1[0m" 204 -
2025-08-20 06:48:14,753 - INFO - github_runner_manager.http_server - Attempting to acquire the lock: unlocked
2025-08-20 06:48:14,753 - INFO - github_runner_manager.http_server - Flushing runners...
2025-08-20 06:48:14,873 - INFO - github_runner_manager.http_server - Flushing busy: False
2025-08-20 06:48:14,873 - INFO - github_runner_manager.manager.runner_manager - runner_manager::cleanup
2025-08-20 06:48:14,873 - INFO - github_runner_manager.manager.runner_manager -  _cleanup_resources idle: False, force: False
2025-08-20 06:48:14,873 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:48:16,732 - INFO - github_runner_manager.manager.runner_manager - cleanup cloud_runners []
2025-08-20 06:48:17,829 - INFO - github_runner_manager.manager.runner_manager - cleanup health_response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:48:19,286 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up SSH key files
2025-08-20 06:48:19,287 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Found 0 key files, clean up 0 key files
2025-08-20 06:48:19,287 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up openstack keypairs
2025-08-20 06:48:19,319 - INFO - github_runner_manager.manager.runner_manager - runner_manager::flush_runners. mode FlushMode.FLUSH_IDLE
2025-08-20 06:48:19,319 - INFO - github_runner_manager.manager.runner_manager - Flushing idle runners...
2025-08-20 06:48:19,319 - INFO - github_runner_manager.manager.runner_manager -  _cleanup_resources idle: True, force: False
2025-08-20 06:48:19,320 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:48:21,155 - INFO - github_runner_manager.manager.runner_manager - cleanup cloud_runners []
2025-08-20 06:48:22,246 - INFO - github_runner_manager.manager.runner_manager - cleanup health_response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:48:24,039 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up SSH key files
2025-08-20 06:48:24,040 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Found 0 key files, clean up 0 key files
2025-08-20 06:48:24,040 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up openstack keypairs
2025-08-20 06:48:24,076 - INFO - github_runner_manager.http_server - Flushed 0 runners
2025-08-20 06:48:24,077 - INFO - werkzeug - 127.0.0.1 - - [20/Aug/2025 06:48:24] "[35m[1mPOST /runner/flush?flush-busy=False HTTP/1.1[0m" 204 -
2025-08-20 06:48:57,316 - INFO - root - Starting GitHub runner manager service version: 0.6.1
2025-08-20 06:48:57,326 - INFO - github_runner_manager.http_server - Starting the server...
2025-08-20 06:48:57,327 - INFO - github_runner_manager.reconcile_service - Starting the reconcile service...
 * Serving Flask app 'github_runner_manager.http_server'
 * Debug mode: off
2025-08-20 06:48:57,327 - INFO - github_runner_manager.reconcile_service - Start reconciliation
2025-08-20 06:48:57,354 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:55555
2025-08-20 06:48:57,354 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-08-20 06:48:57,362 - INFO - github_runner_manager.manager.runner_scaler - Start reconcile. base_quantity 1. max_quantity: 0.
2025-08-20 06:48:57,362 - INFO - github_runner_manager.manager.runner_manager - runner_manager::cleanup
2025-08-20 06:48:57,363 - INFO - github_runner_manager.manager.runner_manager -  _cleanup_resources idle: False, force: False
2025-08-20 06:48:57,363 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:48:59,515 - INFO - github_runner_manager.manager.runner_manager - cleanup cloud_runners []
2025-08-20 06:49:00,646 - INFO - github_runner_manager.manager.runner_manager - cleanup health_response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:49:02,966 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up SSH key files
2025-08-20 06:49:02,966 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Found 0 key files, clean up 0 key files
2025-08-20 06:49:02,967 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up openstack keypairs
2025-08-20 06:49:02,991 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:49:06,514 - INFO - github_runner_manager.manager.runner_manager - clouds runners response []
2025-08-20 06:49:06,514 - INFO - github_runner_manager.manager.runner_manager - runner health response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:49:06,514 - INFO - github_runner_manager.manager.runner_scaler - Reconcile runners from 0 to 1
2025-08-20 06:49:06,514 - INFO - github_runner_manager.manager.runner_manager - Creating 1 runners
2025-08-20 06:49:07,164 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Creating openstack server with RunnerIdentity(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name=<Platform.GITHUB: 'github'>, runner_id='10266', url=None))
2025-08-20 06:49:09,563 - INFO - github_runner_manager.openstack_cloud.openstack_runner_manager - Runner test-q1eaji6r-0-n-cffb67716e25 created successfully
2025-08-20 06:49:09,564 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:49:11,598 - INFO - werkzeug - 127.0.0.1 - - [20/Aug/2025 06:49:11] "[35m[1mGET /health HTTP/1.1[0m" 204 -
2025-08-20 06:49:12,679 - INFO - github_runner_manager.manager.runner_manager - clouds runners response [VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.CREATED: '1'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc))]
2025-08-20 06:49:12,679 - INFO - github_runner_manager.manager.runner_manager - runner health response RunnersHealthResponse(requested_runners=[PlatformRunnerHealth(identity=VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.CREATED: '1'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc)), online=False, busy=False, deletable=False, runner_in_platform=True)], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:49:12,680 - INFO - github_runner_manager.manager.runner_scaler - Runner test-q1eaji6r-0-n-cffb67716e25: state=PlatformRunnerState.OFFLINE, health=HealthState.UNKNOWN
2025-08-20 06:49:12,680 - INFO - github_runner_manager.manager.runner_scaler - Found 0 busy runners: []
2025-08-20 06:49:12,680 - INFO - github_runner_manager.manager.runner_scaler - Found 0 idle runners: []
2025-08-20 06:49:12,680 - INFO - github_runner_manager.manager.runner_scaler - Found 0 offline runners that are healthy: []
2025-08-20 06:49:12,680 - INFO - github_runner_manager.manager.runner_scaler - Found 1 unhealthy runners: [RunnerInstance(name='test-q1eaji6r-0-n-cffb67716e25', instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), platform_state=<PlatformRunnerState.OFFLINE: '3'>, platform_health=PlatformRunnerHealth(identity=VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.CREATED: '1'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc)), online=False, busy=False, deletable=False, runner_in_platform=True), cloud_state=<VMState.CREATED: '1'>)]
2025-08-20 06:49:12,680 - INFO - github_runner_manager.manager.runner_scaler - Current available runners (idle + healthy offline): set()
2025-08-20 06:49:12,681 - INFO - github_runner_manager.manager.runner_scaler - Current active runners: set()
2025-08-20 06:49:12,681 - INFO - github_runner_manager.manager.runner_scaler - Finished reconciliation.
2025-08-20 06:49:12,681 - INFO - github_runner_manager.reconcile_service - Change in number of runner after reconcile: 1
2025-08-20 06:49:12,681 - INFO - github_runner_manager.reconcile_service - End reconciliation
2025-08-20 06:51:12,741 - INFO - github_runner_manager.reconcile_service - Start reconciliation
2025-08-20 06:51:12,775 - INFO - github_runner_manager.manager.runner_scaler - Start reconcile. base_quantity 1. max_quantity: 0.
2025-08-20 06:51:12,775 - INFO - github_runner_manager.manager.runner_manager - runner_manager::cleanup
2025-08-20 06:51:12,775 - INFO - github_runner_manager.manager.runner_manager -  _cleanup_resources idle: False, force: False
2025-08-20 06:51:12,776 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:51:14,920 - INFO - github_runner_manager.manager.runner_manager - cleanup cloud_runners [VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc))]
2025-08-20 06:51:16,081 - INFO - github_runner_manager.manager.runner_manager - cleanup health_response RunnersHealthResponse(requested_runners=[PlatformRunnerHealth(identity=VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc)), online=True, busy=False, deletable=False, runner_in_platform=True)], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:51:17,654 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up SSH key files
2025-08-20 06:51:17,654 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Found 1 key files, clean up 0 key files
2025-08-20 06:51:17,654 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up openstack keypairs
2025-08-20 06:51:17,682 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:51:20,528 - INFO - github_runner_manager.manager.runner_manager - clouds runners response [VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc))]
2025-08-20 06:51:20,528 - INFO - github_runner_manager.manager.runner_manager - runner health response RunnersHealthResponse(requested_runners=[PlatformRunnerHealth(identity=VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc)), online=True, busy=False, deletable=False, runner_in_platform=True)], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:51:20,528 - INFO - github_runner_manager.manager.runner_scaler - Reconcile runners from 1 to 1
2025-08-20 06:51:20,528 - INFO - github_runner_manager.manager.runner_scaler - No changes to the number of runners.
2025-08-20 06:51:20,528 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:51:23,226 - INFO - github_runner_manager.manager.runner_manager - clouds runners response [VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc))]
2025-08-20 06:51:23,226 - INFO - github_runner_manager.manager.runner_manager - runner health response RunnersHealthResponse(requested_runners=[PlatformRunnerHealth(identity=VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc)), online=True, busy=False, deletable=False, runner_in_platform=True)], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:51:23,226 - INFO - github_runner_manager.manager.runner_scaler - Runner test-q1eaji6r-0-n-cffb67716e25: state=PlatformRunnerState.IDLE, health=HealthState.HEALTHY
2025-08-20 06:51:23,226 - INFO - github_runner_manager.manager.runner_scaler - Found 0 busy runners: []
2025-08-20 06:51:23,226 - INFO - github_runner_manager.manager.runner_scaler - Found 1 idle runners: [RunnerInstance(name='test-q1eaji6r-0-n-cffb67716e25', instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), platform_state=<PlatformRunnerState.IDLE: '2'>, platform_health=PlatformRunnerHealth(identity=VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc)), online=True, busy=False, deletable=False, runner_in_platform=True), cloud_state=<VMState.ACTIVE: '2'>)]
2025-08-20 06:51:23,227 - INFO - github_runner_manager.manager.runner_scaler - Found 0 offline runners that are healthy: []
2025-08-20 06:51:23,227 - INFO - github_runner_manager.manager.runner_scaler - Found 0 unhealthy runners: []
2025-08-20 06:51:23,227 - INFO - github_runner_manager.manager.runner_scaler - Current available runners (idle + healthy offline): {'test-q1eaji6r-0-n-cffb67716e25'}
2025-08-20 06:51:23,227 - INFO - github_runner_manager.manager.runner_scaler - Current active runners: set()
2025-08-20 06:51:23,227 - INFO - github_runner_manager.manager.runner_scaler - Finished reconciliation.
2025-08-20 06:51:23,227 - INFO - github_runner_manager.reconcile_service - Change in number of runner after reconcile: 0
2025-08-20 06:51:23,227 - INFO - github_runner_manager.reconcile_service - End reconciliation
2025-08-20 06:51:31,531 - INFO - werkzeug - 127.0.0.1 - - [20/Aug/2025 06:51:31] "[35m[1mGET /health HTTP/1.1[0m" 204 -
2025-08-20 06:51:31,544 - INFO - github_runner_manager.http_server - Checking runners...
2025-08-20 06:51:31,578 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:51:35,059 - INFO - github_runner_manager.manager.runner_manager - clouds runners response [VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc))]
2025-08-20 06:51:35,060 - INFO - github_runner_manager.manager.runner_manager - runner health response RunnersHealthResponse(requested_runners=[PlatformRunnerHealth(identity=VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc)), online=True, busy=False, deletable=False, runner_in_platform=True)], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:51:35,061 - INFO - werkzeug - 127.0.0.1 - - [20/Aug/2025 06:51:35] "GET /runner/check HTTP/1.1" 200 -
2025-08-20 06:51:37,739 - INFO - root - Starting GitHub runner manager service version: 0.6.1
2025-08-20 06:51:37,749 - INFO - github_runner_manager.http_server - Starting the server...
2025-08-20 06:51:37,749 - INFO - github_runner_manager.reconcile_service - Starting the reconcile service...
 * Serving Flask app 'github_runner_manager.http_server'
 * Debug mode: off
2025-08-20 06:51:37,750 - INFO - github_runner_manager.reconcile_service - Start reconciliation
2025-08-20 06:51:37,756 - INFO - werkzeug - [31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on http://127.0.0.1:55555
2025-08-20 06:51:37,757 - INFO - werkzeug - [33mPress CTRL+C to quit[0m
2025-08-20 06:51:37,787 - INFO - github_runner_manager.manager.runner_scaler - Start reconcile. base_quantity 1. max_quantity: 0.
2025-08-20 06:51:37,787 - INFO - github_runner_manager.manager.runner_manager - runner_manager::cleanup
2025-08-20 06:51:37,787 - INFO - github_runner_manager.manager.runner_manager -  _cleanup_resources idle: False, force: False
2025-08-20 06:51:37,787 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:51:39,920 - INFO - github_runner_manager.manager.runner_manager - cleanup cloud_runners [VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc))]
2025-08-20 06:51:41,249 - INFO - github_runner_manager.manager.runner_manager - cleanup health_response RunnersHealthResponse(requested_runners=[PlatformRunnerHealth(identity=VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc)), online=False, busy=False, deletable=True, runner_in_platform=False)], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:51:43,411 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up SSH key files
2025-08-20 06:51:43,411 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Found 1 key files, clean up 0 key files
2025-08-20 06:51:43,412 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up openstack keypairs
2025-08-20 06:51:43,444 - INFO - github_runner_manager.manager.runner_manager - Deleting runners from platform: ['10266']
2025-08-20 06:51:43,445 - INFO - github_runner_manager.platform.github_provider - Delete runners from GitHub provider: ['10266']
2025-08-20 06:51:44,005 - INFO - github_runner_manager.manager.runner_manager - Deleted runners from platform: ['10266'] (diff: set())
2025-08-20 06:51:44,005 - INFO - github_runner_manager.manager.runner_manager - Cloud runners: [VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc))]
2025-08-20 06:51:44,005 - INFO - github_runner_manager.manager.runner_manager - Extracting metrics from cloud VMs: [InstanceID('test-q1eaji6r-0-n-cffb67716e25')]
2025-08-20 06:51:44,005 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting openstack server with test-q1eaji6r-0-n-cffb67716e25
2025-08-20 06:51:45,344 - INFO - paramiko.transport - Connected (version 2.0, client OpenSSH_9.6p1)
2025-08-20 06:51:45,411 - INFO - paramiko.transport - Authentication (publickey) successful!
2025-08-20 06:51:46,127 - INFO - paramiko.transport.sftp - [chan 2] Opened sftp connection (server version 3)
2025-08-20 06:51:46,157 - WARNING - github_runner_manager.metrics.runner - Unable to get file size of /home/ubuntu/metrics-exchange/pre-job-metrics.json on instance 10.145.193.115, exit code: 1, stdout: , stderr: stat: cannot statx '/home/ubuntu/metrics-exchange/pre-job-metrics.json': No such file or directory

2025-08-20 06:51:46,158 - WARNING - github_runner_manager.metrics.runner - Failed to pull file pre-job-metrics.json metrics for test-q1eaji6r-0-n-cffb67716e25: Unable to get file size of /home/ubuntu/metrics-exchange/pre-job-metrics.json.
2025-08-20 06:51:46,195 - WARNING - github_runner_manager.metrics.runner - Unable to get file size of /home/ubuntu/metrics-exchange/post-job-metrics.json on instance 10.145.193.115, exit code: 1, stdout: , stderr: stat: cannot statx '/home/ubuntu/metrics-exchange/post-job-metrics.json': No such file or directory

2025-08-20 06:51:46,195 - WARNING - github_runner_manager.metrics.runner - Failed to pull file post-job-metrics.json metrics for test-q1eaji6r-0-n-cffb67716e25: Unable to get file size of /home/ubuntu/metrics-exchange/post-job-metrics.json.
2025-08-20 06:51:46,195 - INFO - paramiko.transport.sftp - [chan 2] sftp session closed.
2025-08-20 06:51:46,196 - INFO - github_runner_manager.manager.runner_manager - Extracted metrics from cloud VMs: [PulledMetrics(instance=OpenstackInstance(addresses=['10.145.193.115'], created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc), instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), server_id='64b1742f-9199-4869-8fe3-5d3becfb1994', status='ACTIVE', metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None)), runner_installed_timestamp=1755672611.0, pre_job=None, post_job=None)]
2025-08-20 06:51:46,199 - INFO - github_runner_manager.manager.runner_manager - Deleting VMs [InstanceID('test-q1eaji6r-0-n-cffb67716e25')]
2025-08-20 06:51:46,201 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Deleting server test-q1eaji6r-0-n-cffb67716e25
2025-08-20 06:51:47,036 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Deleted server test-q1eaji6r-0-n-cffb67716e25 (true delete: True)
2025-08-20 06:51:47,036 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Deleting key: test-q1eaji6r-0-n-cffb67716e25
2025-08-20 06:51:47,060 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Deleted key: test-q1eaji6r-0-n-cffb67716e25
2025-08-20 06:51:47,060 - INFO - github_runner_manager.manager.runner_manager - Deleted VMs: [InstanceID('test-q1eaji6r-0-n-cffb67716e25')], (diff: set())
2025-08-20 06:51:47,061 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:51:49,803 - INFO - github_runner_manager.manager.runner_manager - clouds runners response [VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc))]
2025-08-20 06:51:49,803 - INFO - github_runner_manager.manager.runner_manager - runner health response RunnersHealthResponse(requested_runners=[PlatformRunnerHealth(identity=VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.ACTIVE: '2'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc)), online=False, busy=False, deletable=True, runner_in_platform=False)], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:51:49,803 - INFO - github_runner_manager.manager.runner_scaler - Reconcile runners from 1 to 1
2025-08-20 06:51:49,803 - INFO - github_runner_manager.manager.runner_scaler - No changes to the number of runners.
2025-08-20 06:51:49,803 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:51:52,016 - INFO - werkzeug - 127.0.0.1 - - [20/Aug/2025 06:51:52] "[35m[1mGET /health HTTP/1.1[0m" 204 -
2025-08-20 06:51:52,034 - INFO - werkzeug - 127.0.0.1 - - [20/Aug/2025 06:51:52] "[35m[1mGET /health HTTP/1.1[0m" 204 -
2025-08-20 06:51:52,046 - INFO - github_runner_manager.http_server - Attempting to acquire the lock: locked
2025-08-20 06:51:52,736 - INFO - github_runner_manager.manager.runner_manager - clouds runners response [VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.DELETED: '3'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc))]
2025-08-20 06:51:52,736 - INFO - github_runner_manager.manager.runner_manager - runner health response RunnersHealthResponse(requested_runners=[PlatformRunnerHealth(identity=VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.DELETED: '3'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc)), online=False, busy=False, deletable=True, runner_in_platform=False)], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:51:52,736 - INFO - github_runner_manager.manager.runner_scaler - Runner test-q1eaji6r-0-n-cffb67716e25: state=PlatformRunnerState.OFFLINE, health=HealthState.UNHEALTHY
2025-08-20 06:51:52,736 - INFO - github_runner_manager.manager.runner_scaler - Found 0 busy runners: []
2025-08-20 06:51:52,737 - INFO - github_runner_manager.manager.runner_scaler - Found 0 idle runners: []
2025-08-20 06:51:52,737 - INFO - github_runner_manager.manager.runner_scaler - Found 0 offline runners that are healthy: []
2025-08-20 06:51:52,737 - INFO - github_runner_manager.manager.runner_scaler - Found 1 unhealthy runners: [RunnerInstance(name='test-q1eaji6r-0-n-cffb67716e25', instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), platform_state=<PlatformRunnerState.OFFLINE: '3'>, platform_health=PlatformRunnerHealth(identity=VM(instance_id=InstanceID('test-q1eaji6r-0-n-cffb67716e25'), metadata=RunnerMetadata(platform_name='github', runner_id='10266', url=None), state=<VMState.DELETED: '3'>, created_at=datetime.datetime(2025, 8, 20, 6, 49, 9, tzinfo=datetime.timezone.utc)), online=False, busy=False, deletable=True, runner_in_platform=False), cloud_state=<VMState.DELETED: '3'>)]
2025-08-20 06:51:52,737 - INFO - github_runner_manager.manager.runner_scaler - Current available runners (idle + healthy offline): set()
2025-08-20 06:51:52,737 - INFO - github_runner_manager.manager.runner_scaler - Current active runners: set()
2025-08-20 06:51:52,738 - INFO - github_runner_manager.manager.runner_scaler - Finished reconciliation.
2025-08-20 06:51:52,738 - INFO - github_runner_manager.reconcile_service - Change in number of runner after reconcile: 0
2025-08-20 06:51:52,738 - INFO - github_runner_manager.reconcile_service - End reconciliation
2025-08-20 06:51:52,738 - INFO - github_runner_manager.http_server - Flushing runners...
2025-08-20 06:51:52,776 - INFO - github_runner_manager.http_server - Flushing busy: False
2025-08-20 06:51:52,776 - INFO - github_runner_manager.manager.runner_manager - runner_manager::cleanup
2025-08-20 06:51:52,776 - INFO - github_runner_manager.manager.runner_manager -  _cleanup_resources idle: False, force: False
2025-08-20 06:51:52,776 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:51:54,832 - INFO - github_runner_manager.manager.runner_manager - cleanup cloud_runners []
2025-08-20 06:51:56,174 - INFO - github_runner_manager.manager.runner_manager - cleanup health_response RunnersHealthResponse(requested_runners=[], failed_requested_runners=[], non_requested_runners=[])
2025-08-20 06:51:57,894 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up SSH key files
2025-08-20 06:51:57,894 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Found 0 key files, clean up 0 key files
2025-08-20 06:51:57,895 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Cleaning up openstack keypairs
2025-08-20 06:51:57,920 - INFO - github_runner_manager.manager.runner_manager - runner_manager::flush_runners. mode FlushMode.FLUSH_IDLE
2025-08-20 06:51:57,921 - INFO - github_runner_manager.manager.runner_manager - Flushing idle runners...
2025-08-20 06:51:57,921 - INFO - github_runner_manager.manager.runner_manager -  _cleanup_resources idle: True, force: False
2025-08-20 06:51:57,921 - INFO - github_runner_manager.openstack_cloud.openstack_cloud - Getting all openstack servers managed by the charm
2025-08-20 06:51:59,601 - INFO - github_runner_manager.manager.runner_manager - cleanup cloud_runners []
2025-08-20 06:52:00,539 - ERROR - github_runner_manager.http_server - Exception on /runner/flush [POST]
Traceback (most recent call last):
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/flask/app.py", line 1511, in wsgi_app
    response = self.full_dispatch_request()
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/flask/app.py", line 919, in full_dispatch_request
    rv = self.handle_user_exception(e)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/flask/app.py", line 917, in full_dispatch_request
    rv = self.dispatch_request()
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/flask/app.py", line 902, in dispatch_request
    return self.ensure_sync(self.view_functions[rule.endpoint])(**view_args)  # type: ignore[no-any-return]
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/github_runner_manager/http_server.py", line 83, in flush_runner
    num_flushed = runner_scaler.flush(flush_mode)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/github_runner_manager/manager/runner_scaler.py", line 272, in flush
    delete_metric_stats = self._manager.flush_runners(flush_mode=flush_mode)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/github_runner_manager/manager/runner_manager.py", line 243, in flush_runners
    extracted_runner_metrics = self._cleanup_resources(
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/github_runner_manager/manager/runner_manager.py", line 272, in _cleanup_resources
    runners_health_response = self._platform.get_runners_health(
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/github_runner_manager/platform/github_provider.py", line 129, in get_runners_health
    github_runners = self._client.list_runners(self._path, self._prefix)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/github_runner_manager/github_client.py", line 77, in wrapper
    return func(*args, **kwargs)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/github_runner_manager/github_client.py", line 166, in list_runners
    for page in pages(
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/ghapi/page.py", line 71, in pages
    return parallel(_call_page, range(1,n_pages+1), oper=oper, per_page=per_page, args=args, kwargs=kwargs,
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/fastcore/parallel.py", line 134, in parallel
    return L(r)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/fastcore/foundation.py", line 100, in __call__
    return super().__call__(x, *args, **kwargs)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/fastcore/foundation.py", line 108, in __init__
    items = listify(items, *rest, use_list=use_list, match=match)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/fastcore/basics.py", line 79, in listify
    elif is_iter(o): res = list(o)
  File "/usr/lib/python3.10/concurrent/futures/_base.py", line 621, in result_iterator
    yield _result_or_cancel(fs.pop())
  File "/usr/lib/python3.10/concurrent/futures/_base.py", line 319, in _result_or_cancel
    return fut.result(timeout)
  File "/usr/lib/python3.10/concurrent/futures/_base.py", line 458, in result
    return self.__get_result()
  File "/usr/lib/python3.10/concurrent/futures/_base.py", line 403, in __get_result
    raise self._exception
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/fastcore/parallel.py", line 63, in _call
    return g(item)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/ghapi/page.py", line 66, in _call_page
    return oper(*args, per_page=per_page, page=i, **kwargs)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/ghapi/core.py", line 74, in __call__
    return self.client(self.path, self.verb, headers=headers, decode=self.decode, route=route_p, query=query_p, data=data_p)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/ghapi/core.py", line 133, in __call__
    res,self.recv_hdrs = urlsend(path, verb, headers=headers or None, decode=decode, debug=debug, return_headers=True,
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/fastcore/net.py", line 221, in urlsend
    return urlread(req, decode=decode, return_json=return_json, return_headers=return_headers, timeout=timeout)
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/fastcore/net.py", line 120, in urlread
    with urlopen(url, data=data, headers=headers, timeout=timeout, **kwargs) as u: res,hdrs = u.read(),u.headers
  File "/opt/pipx/venvs/github-runner-manager/lib/python3.10/site-packages/fastcore/net.py", line 111, in urlopen
    try: return urlopener().open(urlwrap(url, data=data, headers=headers), timeout=timeout)
  File "/usr/lib/python3.10/urllib/request.py", line 519, in open
    response = self._open(req, data)
  File "/usr/lib/python3.10/urllib/request.py", line 536, in _open
    result = self._call_chain(self.handle_open, protocol, protocol +
  File "/usr/lib/python3.10/urllib/request.py", line 496, in _call_chain
    result = func(*args)
  File "/usr/lib/python3.10/urllib/request.py", line 1391, in https_open
    return self.do_open(http.client.HTTPSConnection, req,
  File "/usr/lib/python3.10/urllib/request.py", line 1352, in do_open
    r = h.getresponse()
  File "/usr/lib/python3.10/http/client.py", line 1375, in getresponse
    response.begin()
  File "/usr/lib/python3.10/http/client.py", line 318, in begin
    version, status, reason = self._read_status()
  File "/usr/lib/python3.10/http/client.py", line 287, in _read_status
    raise RemoteDisconnected("Remote end closed connection without"
http.client.RemoteDisconnected: Remote end closed connection without response
2025-08-20 06:52:00,545 - INFO - werkzeug - 127.0.0.1 - - [20/Aug/2025 06:52:00] "[35m[1mPOST /runner/flush?flush-busy=False HTTP/1.1[0m" 500 -

06:52:02 INFO OpenStack servers: []
06:52:03 INFO Model status:

Model                             Controller           Cloud/Region         Version  SLA          Timestamp
test-charm-fork-path-change-e5yu  github-pr-539f0-lxd  localhost/localhost  3.6.9    unsupported  06:52:03Z

App                                   Version  Status  Scale  Charm                        Channel      Rev  Exposed  Message
github-runner-image-builder-q1eaji6r           active      1  github-runner-image-builder  latest/edge  106  no       
test-q1eaji6r                                  error       1  github-runner                               0  no       hook failed: "config-changed"

Unit                                     Workload  Agent  Machine  Public address  Ports  Message
github-runner-image-builder-q1eaji6r/0*  active    idle   0        10.18.41.98            
test-q1eaji6r/0*                         error     idle   1        10.18.41.68            hook failed: "config-changed"

Machine  State    Address      Inst id        Base          AZ             Message
0        started  10.18.41.98  juju-11e0ad-0  ubuntu@22.04  github-runner  Running
1        started  10.18.41.68  juju-11e0ad-1  ubuntu@22.04  github-runner  Running

06:52:03 INFO Juju error logs:

machine-0: 06:27:05 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-0: 06:27:05 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-github-runner-image-builder-q1eaji6r-0: 06:27:05 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-github-runner-image-builder-q1eaji6r-0: 06:29:10 ERROR unit.github-runner-image-builder-q1eaji6r/0.juju-log Pipx command failed, code: 1, out: None, err: None
machine-1: 06:31:28 ERROR juju.worker.dependency "lxd-container-provisioner" manifold worker returned unexpected error: container types not yet available
machine-1: 06:31:28 ERROR juju.worker.dependency "kvm-container-provisioner" manifold worker returned unexpected error: container types not yet available
unit-test-q1eaji6r-0: 06:31:28 ERROR juju.worker.meterstatus error running "meter-status-changed": charm missing from disk
unit-test-q1eaji6r-0: 06:33:55 ERROR unit.test-q1eaji6r/0.juju-log Missing image integration.
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/./src/charm.py", line 118, in func_with_catch_errors
    func(self, event)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/./src/charm.py", line 342, in _on_config_changed
    self._check_image_ready()
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/./src/charm.py", line 512, in _check_image_ready
    raise ImageIntegrationMissingError("No image integration found")
errors.ImageIntegrationMissingError: No image integration found
unit-test-q1eaji6r-0: 06:33:58 ERROR unit.test-q1eaji6r/0.juju-log Missing image integration.
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/./src/charm.py", line 118, in func_with_catch_errors
    func(self, event)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/./src/charm.py", line 313, in _on_start
    self._check_image_ready()
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/./src/charm.py", line 512, in _check_image_ready
    raise ImageIntegrationMissingError("No image integration found")
errors.ImageIntegrationMissingError: No image integration found
unit-test-q1eaji6r-0: 06:34:01 ERROR unit.test-q1eaji6r/0.juju-log image:0: Missing image in image integration.
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/./src/charm.py", line 118, in func_with_catch_errors
    func(self, event)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/./src/charm.py", line 477, in _on_image_relation_changed
    self._check_image_ready()
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/./src/charm.py", line 514, in _check_image_ready
    raise ImageNotFoundError("No image found in the image integration")
errors.ImageNotFoundError: No image found in the image integration
unit-test-q1eaji6r-0: 06:52:00 ERROR unit.test-q1eaji6r/0.juju-log Failed request with code 500: <!doctype html>
<html lang=en>
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.</p>

unit-test-q1eaji6r-0: 06:52:00 ERROR unit.test-q1eaji6r/0.juju-log Uncaught exception while in charm code:
Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/src/manager_client.py", line 60, in func_with_error_handling
    return func(*args, **kwargs)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/src/manager_client.py", line 148, in flush_runner
    self._request(_HTTPMethod.POST, "/runner/flush", params=params, timeout=WRITE_TIMEOUT)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/src/manager_client.py", line 121, in _request
    response.raise_for_status()
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/venv/requests/models.py", line 1026, in raise_for_status
    raise HTTPError(http_error_msg, response=self)
requests.exceptions.HTTPError: 500 Server Error: INTERNAL SERVER ERROR for url: http://127.0.0.1:55555/runner/flush?flush-busy=False

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/./src/charm.py", line 604, in <module>
    ops.main(GithubRunnerCharm)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/venv/ops/__init__.py", line 356, in __call__
    return _main.main(charm_class=charm_class, use_juju_for_storage=use_juju_for_storage)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/venv/ops/_main.py", line 504, in main
    manager.run()
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/venv/ops/_main.py", line 488, in run
    self._emit()
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/venv/ops/_main.py", line 423, in _emit
    self._emit_charm_event(self.dispatcher.event_name)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/venv/ops/_main.py", line 467, in _emit_charm_event
    event_to_emit.emit(*args, **kwargs)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/venv/ops/framework.py", line 351, in emit
    framework._emit(event)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/venv/ops/framework.py", line 924, in _emit
    self._reemit(event_path)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/venv/ops/framework.py", line 1030, in _reemit
    custom_handler(event)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/./src/charm.py", line 118, in func_with_catch_errors
    func(self, event)
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/./src/charm.py", line 348, in _on_config_changed
    self._manager_client.flush_runner()
  File "/var/lib/juju/agents/unit-test-q1eaji6r-0/charm/src/manager_client.py", line 67, in func_with_error_handling
    raise RunnerManagerServiceResponseError(
errors.RunnerManagerServiceResponseError: Failed request with code 500: <!doctype html>
<html lang=en>
<title>500 Internal Server Error</title>
<h1>Internal Server Error</h1>
<p>The server encountered an internal error and was unable to complete your request. Either the server is overloaded or there is an error in the application.</p>

unit-test-q1eaji6r-0: 06:52:01 ERROR juju.worker.uniter.operation hook "config-changed" (via hook dispatching script: dispatch) failed: exit status 1

06:52:03 INFO Forgetting model main...